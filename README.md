# Contract-test-practice
Contract testing is a methodology for ensuring that two separate systems (such as two microservices) are compatible 
and can communicate with one other. It captures the interactions that are exchanged between each service, storing them in a contract, 
which then can be used to verify that both parties adhere to it.

What sets this form of testing apart from other approaches that aim to achieve the same thing is that each system can be tested independently from the other 
and that the contract is generated by the code itself, meaning the contract is always kept up to date. 

**CLI Installation (Ubuntu)**

* curl -LO https://github.com/pact-foundation/pact-ruby-standalone/releases/download/v2.0.12/pact-2.0.12-linux-x86_64.tar.gz

* tar xzf pact-2.0.12-linux-x86_64.tar.gz

* export PATH=$PATH:/home/<user>/pact/bin (Add to path)

* pact-broker version

**Contract Testing (Without any Pact tool involved, good for development environment):**


**Client contract test**-->

* go test -v (client folder path)


**Server contract test**-->

* Run the command go run cmd/main.go on one terminal to start the service

* Open the same project in another terminal

* Run command go test -v (server folder path)



**Contract Testing (PactFlow tool, good for production environment)**:


**Client contract test (Publish contract to Pactflow tool)**-->

* Run the command "go test -v <client folder path>" to generate the contract in the pact folder:

* Set the environment variable : export SSL_CERT_FILE=<path to ssl certificate>

* Run the command to publish the contract to the pactflow tool:

* pact-broker publish (contract-file-path) --consumer-app-version (consumer-version) --branch main --broker-base-url (pact-broker-url) --tag testing --broker-token (pact-token)

Example data :

        <contract-file-path> = $HOME/pkg/client/pacts/example-client-example-server.json
        
        <consumer-version> = 1.0.0
        
        <pact-broker-url> = https://testhpe.pactflow.io/


**Server contract test**-->

* Run command go test -v (server folder path) with parameter PublishVerificationResults said to true to verify the contract in pactflow tool


**Using Can I deploy feature**:

Before we deploy a new version of an application to a environment, 
we need to know whether or not the version we're about to deploy is compatible with the versions of the other apps that already exist in that environment.

* pact-broker can-i-deploy --pacticipant (pacticipant-name) --version (pacticipant-version) --broker-base-url="(pact-broker-url)" --broker-token (pact-token)

 Example data:
 
    <pacticipant-name> = example-client  
    
    <pacticipant-version> = 1.0.0
    
    <pact-broker-url> = https://testhpe.pactflow.io/


**Using "record-deployment" feature**:


Record-deployment is used to model the real life scenario where a deployment causes the previous version of an application to be replaced by a new version.

When called, it automatically marks the previously deployed version as undeployed.


* pact-broker record-deployment --pacticipant (pacticipant-name) --environment (env-type) --version (pacticipant-version)--broker-base-url="(pact-broker-url)" --broker-token (pact-token)


 Example data:
 
    <pacticipant-name> = example-client  
    
    <env-type> = test (can be integ, prod)
    
    <pacticipant-version> = 1.0.0
    
    <pact-broker-url> = https://testhpe.pactflow.io/
